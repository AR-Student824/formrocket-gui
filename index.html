<!DOCTYPE html>
<html>
    <head>
        <title>Formrocket-gui</title>
        
    </head>
    <body>


<link rel="stylesheet" href="https://cdn.rawgit.com/kimeiga/bahunya/css/bahunya-0.1.3.css"/>
<div id="load">
    <center><h2>Checking...</h2></center>
    <noscript><p>You are stuck on this page due to JavaScript not being enabled. Note, JS should never be disabled on your browser unless if you are testing.</p></noscript>
</div>
        <div id="mainNotConnected" style="display:none;">
            <center>
            <h1>FormRocket-GUI</h1>
            <p>Connect to a form by filling out the details below. Everything can be found from the official FormRocket dashboard.</p>
            <p id="noInp">You haven't inputted the required details. Click the connect button to (re)check &amp; attempt to connect.</p>
            <p id="error" style="color: red;display:none;"></p>
            <form action="/">
                <input type="text" name="userId" placeholder="User ID" required>
                <input type="text" name="formName" placeholder="Form Name (Case sensitive)" required>
                <input type="text" name="formId" placeholder="Form ID" required>
                <input type="password" name="formSecret" placeholder="Form secret" required>
                <input type="submit" value="Connect ⇒">
            </form>
        </center>

        </div>

        <div id="mainConnected" style="display:none;">
            <center>
            <h1>Connected to <span id="formName"></span></h1>
            <a href="./"><button style="background-color: red;color:white;">Disconnect ⇒</button></a>
            <p></p>
            <h3>Responses</h3>
            <p>A list of the responses from your form. <sup>JSON List</sup></p>
            <div id="responses">
                Loading
            </div>

            <h3>Raw data</h3>
            <p>Raw data from the response of the request sent to FormRocket to get your form&apos;s details. <sup>JSON</sup></p>
            </center>
            <pre id="rawData" style="margin-right: 30%;margin-left: 30%;color:#d17073;background-color:#2d2d2d;border-radius:8px;padding:10px;"></pre>

        </div>
        <script>
            console.log('[Info] Do not enter anything in here, as it could give attackers access to your forms, and/or your formSecret, which should not be shared with anyone.')
            function escape(unsafe) {
    return unsafe ? unsafe
         .replace(/&/g, "&amp;")
         .replace(/</g, "&lt;")
         .replace(/>/g, "&gt;")
         .replace(/"/g, "&quot;")
         .replace(/'/g, "&#039;") : null
 }
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('userId');
            const formName = urlParams.get('formName');
            const formId = urlParams.get('formId')
            const formSecret = urlParams.get('formSecret')
            const errCode = urlParams.get('code')
            const errMsg = urlParams.get('msg')
            var d = {}

            if (!userId || !formName || !formId || !formSecret) {
                document.getElementById('mainNotConnected').style.display = 'initial'
                document.getElementById('load').style.display = 'none'
                if (errCode && errMsg) {
                    document.getElementById('error').innerHTML = `<u>[${escape(errCode)}]</u> ${escape(errMsg)}`
                    document.getElementById('error').style.display = 'none'
                    document.getElementById('noInp').style.display = 'none'
                }
            } else {
                fetch('https://proxy.hackeryou.com/?reqUrl=https://www.formrocket.me/api/forms/' + userId + '/' + formName + '/' + formId + '/' + formSecret + '/get').then(res => res.json()).then(res => {
                    d = res
                    if (res.error) {
                        window.location.href = "./?code=" + res.error.code + "&msg=" + res.error.data
                    } else {
                        document.getElementById('mainConnected').style.display = 'initial'
                        document.getElementById('load').style.display = 'none'
                        document.getElementById('formName').innerHTML = `<u>${escape(res.data.form.formName) || 'Unknown'}</u>`
                        document.getElementById('responses').innerHTML = `<p>${res.data.form.responses.all ? res.data.form.responses.all.map((i, b) => `<span title="${i.id}"><b>${b + 1}</b> <code>${escape(JSON.stringify(i.data))}</code></span><br />`) : 'Nothing here yet!'}</p>`
                        document.getElementById('rawData').innerHTML = `${escape(JSON.stringify(res, null, '\t'))}`
                        console.log(res)
                    }
                })
            }

        </script>
    </body>
</html>
